"use strict";(self.webpackChunkdynet=self.webpackChunkdynet||[]).push([[13],{4677:(s,e,a)=>{a.d(e,{Z:()=>l,y:()=>t});var i=a(3263);const r={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE_URL||"https://backend-dynet2-1.onrender.com",t=i.Z.create({baseURL:r,headers:{"Content-Type":"application/json"},withCredentials:!0}),c=i.Z.create({baseURL:r,headers:{"Content-Type":"application/json"},withCredentials:!0});c.interceptors.response.use((s=>s),(async s=>{var e;return 401===(null===(e=s.response)||void 0===e?void 0:e.status)&&(localStorage.removeItem("accessToken"),localStorage.removeItem("roles"),window.location.href="/login"),Promise.reject(s)}));const l=c},6965:(s,e,a)=>{a.d(e,{Z:()=>d});var i=a(1413),r=a(2791),t=a(4677),c=a(4391),l=a(7834),n=a(3263);const d=()=>{const{auth:s,setAuth:e,logout:a}=(0,l.Z)();return(0,r.useEffect)((()=>{const r=t.Z.interceptors.request.use((e=>(e.headers.Authorization||(e.headers.Authorization="Bearer ".concat(null===s||void 0===s?void 0:s.accessToken)),e)),(s=>Promise.reject(s))),l=t.Z.interceptors.response.use((s=>s),(async s=>{var r,l;const d=null===s||void 0===s?void 0:s.config;if(403===(null===(r=s.response)||void 0===r?void 0:r.status)&&(null===d||void 0===d||!d.sent)){d.sent=!0;try{c.Z.log("Token expired, attempting refresh...");const s=(await n.Z.get("/refresh",{withCredentials:!0})).data.accessToken;return e((e=>(0,i.Z)((0,i.Z)({},e),{},{accessToken:s}))),localStorage.setItem("accessToken",s),d.headers.Authorization="Bearer ".concat(s),(0,t.Z)(d)}catch(o){c.Z.error("Token refresh failed:",o),a()}}return 401===(null===(l=s.response)||void 0===l?void 0:l.status)&&a(),Promise.reject(s)}));return()=>{t.Z.interceptors.request.eject(r),t.Z.interceptors.response.eject(l)}}),[s,e,a]),t.Z}},8013:(s,e,a)=>{a.r(e),a.d(e,{default:()=>h});var i=a(1413),r=a(2791),t=a(6965),c=a(4391),l=a(7834),n=a(8421),d=a(9234),o=a(184);const h=()=>{const s=(0,t.Z)(),{auth:e}=(0,l.Z)(),[a,h]=(0,r.useState)(!1),[m,v]=(0,r.useState)([]),[p,x]=(0,r.useState)(null),[j,N]=(0,r.useState)(!1),[u,g]=(0,r.useState)({totalCities:0,totalAreas:0,totalDistricts:0,totalBuildings:0,totalFlats:0,completedInstallations:0,pendingInstallations:0,scheduledAppointments:0}),[y,b]=(0,r.useState)(!0),f=async()=>{h(!0),x(null);try{const e=await s.get("/api/district/all");v(e.data)}catch(p){c.Z.error("Error fetching all districts:",p),x("Failed to fetch districts")}finally{h(!1)}};(0,r.useEffect)((()=>{f(),(async()=>{try{const e=await s.get("/api/dashboard/stats");g(e.data),b(!1)}catch(p){c.Z.error("Error fetching dashboard data:",p),g({totalCities:1,totalAreas:3,totalDistricts:8,totalBuildings:45,totalFlats:350,completedInstallations:89,pendingInstallations:261,scheduledAppointments:12}),b(!1)}})()}),[]);const T=()=>(0,o.jsxs)("div",{className:"process-flow-container",children:[(0,o.jsx)("h2",{className:"process-flow-title",children:"Fiber Installation Process Overview"}),(0,o.jsxs)("div",{className:"hierarchy-section",children:[(0,o.jsx)("h3",{className:"hierarchy-title",children:"Location Hierarchy"}),(0,o.jsxs)("div",{className:"hierarchy-container",children:[(0,o.jsxs)("div",{className:"hierarchy-box",children:[(0,o.jsx)("div",{className:"hierarchy-icon cities",children:"\ud83c\udfd9\ufe0f"}),(0,o.jsx)("div",{children:"Cities"}),(0,o.jsx)("div",{className:"hierarchy-count",children:u.totalCities})]}),(0,o.jsx)("div",{className:"hierarchy-arrow",children:"\u2192"}),(0,o.jsxs)("div",{className:"hierarchy-box",children:[(0,o.jsx)("div",{className:"hierarchy-icon areas",children:"\ud83d\uddfa\ufe0f"}),(0,o.jsx)("div",{children:"Areas"}),(0,o.jsx)("div",{className:"hierarchy-count",children:u.totalAreas})]}),(0,o.jsx)("div",{className:"hierarchy-arrow",children:"\u2192"}),(0,o.jsxs)("div",{className:"hierarchy-box",children:[(0,o.jsx)("div",{className:"hierarchy-icon districts",children:"\ud83d\udccd"}),(0,o.jsx)("div",{children:"Districts"}),(0,o.jsx)("div",{className:"hierarchy-count",children:u.totalDistricts})]}),(0,o.jsx)("div",{className:"hierarchy-arrow",children:"\u2192"}),(0,o.jsxs)("div",{className:"hierarchy-box",children:[(0,o.jsx)("div",{className:"hierarchy-icon buildings",children:"\ud83c\udfe2"}),(0,o.jsx)("div",{children:"Buildings"}),(0,o.jsx)("div",{className:"hierarchy-count",children:u.totalBuildings})]}),(0,o.jsx)("div",{className:"hierarchy-arrow",children:"\u2192"}),(0,o.jsxs)("div",{className:"hierarchy-box",children:[(0,o.jsx)("div",{className:"hierarchy-icon apartments",children:"\ud83c\udfe0"}),(0,o.jsx)("div",{children:"Apartments"}),(0,o.jsx)("div",{className:"hierarchy-count",children:u.totalFlats})]})]})]}),(0,o.jsxs)("div",{className:"process-section",children:[(0,o.jsx)("h3",{className:"process-title",children:"Installation Process Flow"}),(0,o.jsxs)("div",{className:"process-container",children:[(0,o.jsxs)("div",{className:"process-step",children:[(0,o.jsx)("div",{className:"process-icon planning",children:"\ud83d\udccb"}),(0,o.jsx)("div",{className:"process-label",children:"Technical Planning"}),(0,o.jsx)("div",{className:"process-role",children:"TP Team"})]}),(0,o.jsx)("div",{className:"process-arrow",children:"\u2192"}),(0,o.jsxs)("div",{className:"process-step",children:[(0,o.jsx)("div",{className:"process-icon survey",children:"\ud83d\udd0d"}),(0,o.jsx)("div",{className:"process-label",children:"Technical Survey"}),(0,o.jsx)("div",{className:"process-role",children:"TS Team"})]}),(0,o.jsx)("div",{className:"process-arrow",children:"\u2192"}),(0,o.jsxs)("div",{className:"process-step",children:[(0,o.jsx)("div",{className:"process-icon preparation",children:"\ud83d\udd27"}),(0,o.jsx)("div",{className:"process-label",children:"Work Preparation"}),(0,o.jsx)("div",{className:"process-role",children:"WV Team"})]}),(0,o.jsx)("div",{className:"process-arrow",children:"\u2192"}),(0,o.jsxs)("div",{className:"process-step",children:[(0,o.jsx)("div",{className:"process-icon has-planning",children:"\ud83d\udcc5"}),(0,o.jsx)("div",{className:"process-label",children:"HAS Planning"}),(0,o.jsx)("div",{className:"process-role",children:"HP Team"})]}),(0,o.jsx)("div",{className:"process-arrow",children:"\u2192"}),(0,o.jsxs)("div",{className:"process-step",children:[(0,o.jsx)("div",{className:"process-icon installation",children:"\u26a1"}),(0,o.jsx)("div",{className:"process-label",children:"Fiber Installation"}),(0,o.jsx)("div",{className:"process-role",children:"HM Team"})]})]})]}),(0,o.jsxs)("div",{className:"status-section",children:[(0,o.jsx)("h3",{className:"status-title",children:"Installation Status Overview"}),(0,o.jsxs)("div",{className:"status-container",children:[(0,o.jsxs)("div",{className:"status-card completed",children:[(0,o.jsx)("div",{className:"status-icon completed",children:"\u2705"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"status-number",children:u.completedInstallations}),(0,o.jsx)("div",{className:"status-label",children:"Completed Installations"})]})]}),(0,o.jsxs)("div",{className:"status-card pending",children:[(0,o.jsx)("div",{className:"status-icon pending",children:"\u23f3"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"status-number",children:u.pendingInstallations}),(0,o.jsx)("div",{className:"status-label",children:"Pending Installations"})]})]}),(0,o.jsxs)("div",{className:"status-card scheduled",children:[(0,o.jsx)("div",{className:"status-icon scheduled",children:"\ud83d\udcc5"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"status-number",children:u.scheduledAppointments}),(0,o.jsx)("div",{className:"status-label",children:"Scheduled This Week"})]})]})]})]}),(0,o.jsxs)("div",{className:"overall-progress",children:[(0,o.jsx)("div",{className:"overall-progress-title",children:"Overall Installation Progress"}),(0,o.jsx)("div",{className:"overall-progress-bar",children:(0,o.jsx)("div",{className:"overall-progress-fill",style:{width:"".concat(u.totalFlats>0?u.completedInstallations/u.totalFlats*100:0,"%")}})}),(0,o.jsxs)("div",{className:"overall-progress-text",children:[u.totalFlats>0?Math.round(u.completedInstallations/u.totalFlats*100):0,"% Complete (",u.completedInstallations," of ",u.totalFlats," apartments)"]})]})]});return(0,o.jsxs)("div",{className:"dashboard-container",children:[!y&&(0,o.jsx)(T,{}),y&&(0,o.jsx)("div",{className:"dashboard-loading",children:"Loading dashboard data..."}),(0,o.jsxs)("div",{className:"district-management-section",children:[(0,o.jsxs)("div",{className:"section-header",children:[(0,o.jsxs)("div",{className:"header-content",children:[(0,o.jsxs)("h1",{className:"section-title",children:[(0,o.jsx)("span",{className:"section-icon",children:"\ud83c\udfe2"}),"District Management Dashboard"]}),(0,o.jsx)("p",{className:"section-description",children:"Manage districts, reorder priorities, and track installation progress across your network"})]}),(0,o.jsx)("div",{className:"header-stats",children:(0,o.jsxs)("div",{className:"quick-stat",children:[(0,o.jsx)("span",{className:"stat-number",children:m.length}),(0,o.jsx)("span",{className:"stat-label",children:"Total Districts"})]})})]}),(0,o.jsxs)("div",{className:"instructions-card",children:[(0,o.jsx)("div",{className:"instructions-icon",children:"\ud83c\udfaf"}),(0,o.jsxs)("div",{className:"instructions-content",children:[(0,o.jsx)("h3",{children:"Priority Management"}),(0,o.jsx)("p",{children:"Drag and drop districts to reorder their priority. The first district gets the highest priority for installation scheduling."})]})]}),a&&(0,o.jsx)("div",{className:"loading-overlay",children:(0,o.jsx)(n.Z,{color:"#3498db"})}),p&&(0,o.jsx)("div",{className:"error-message",children:p}),j&&(0,o.jsx)("div",{className:"saving-message",children:"Saving priority changes..."}),!a&&0===m.length&&!p&&(0,o.jsxs)("div",{className:"empty-state",children:[(0,o.jsx)("div",{className:"empty-icon",children:"\ud83c\udfd7\ufe0f"}),(0,o.jsx)("h3",{children:"No Districts Found"}),(0,o.jsx)("p",{children:"Start by creating your first district to organize your network infrastructure."})]}),m.length>0&&(0,o.jsx)(d.Z5,{onDragEnd:async e=>{if(!e.destination)return;const a=Array.from(m),[i]=a.splice(e.source.index,1);a.splice(e.destination.index,0,i),v(a),N(!0);try{await s.post("/api/district/priority",{districts:a.map((s=>({id:s._id})))})}catch(p){c.Z.error("Failed to update priorities",p),f()}finally{N(!1)}},children:(0,o.jsx)(d.bK,{droppableId:"districts",children:s=>(0,o.jsxs)("div",(0,i.Z)((0,i.Z)({},s.droppableProps),{},{ref:s.innerRef,className:"districts-container",children:[m.map(((s,e)=>(0,o.jsx)(d._l,{draggableId:s._id,index:e,children:(a,r)=>{var t,c,l,n,d,h,m,v;return(0,o.jsxs)("div",(0,i.Z)((0,i.Z)({ref:a.innerRef},a.draggableProps),{},{className:"district-card ".concat(r.isDragging?"dragging":""),children:[(0,o.jsxs)("div",{className:"district-header",children:[(0,o.jsxs)("div",{className:"district-info",children:[(0,o.jsxs)("h3",{children:[(0,o.jsx)("span",{className:"district-icon",children:"\ud83c\udfe2"}),s.name]}),(0,o.jsx)("div",{className:"district-meta",children:(null===(t=s.area)||void 0===t?void 0:t.name)&&(0,o.jsxs)("span",{className:"area-tag",children:["\ud83d\udccd ",s.area.name]})})]}),(0,o.jsxs)("div",{className:"district-priority",children:[(0,o.jsx)("span",{className:"priority-icon",children:"\ud83c\udfaf"}),"#",e+1,0===e&&(0,o.jsx)("span",{className:"priority-text",children:"Priority"})]}),(0,o.jsx)("div",(0,i.Z)((0,i.Z)({},a.dragHandleProps),{},{className:"drag-handle",children:"\u22ee\u22ee"}))]}),(0,o.jsxs)("div",{className:"stats-container",children:[(0,o.jsxs)("div",{className:"stat-item",children:[(0,o.jsx)("span",{className:"stat-label",children:"Total Flats:"}),(0,o.jsx)("span",{className:"stat-value",children:(null===(c=s.stats)||void 0===c?void 0:c.totalFlats)||0})]}),(0,o.jsxs)("div",{className:"stat-item",children:[(0,o.jsx)("span",{className:"stat-label",children:"Completed:"}),(0,o.jsx)("span",{className:"stat-value",children:(null===(l=s.stats)||void 0===l?void 0:l.completedFlats)||0})]}),(0,o.jsxs)("div",{className:"stat-item",children:[(0,o.jsx)("span",{className:"stat-label",children:"Remaining:"}),(0,o.jsx)("span",{className:"stat-value",children:(null===(n=s.stats)||void 0===n?void 0:n.remainingFlats)||0})]})]}),(0,o.jsxs)("div",{className:"progress-section",children:[(0,o.jsxs)("div",{className:"progress-header",children:[(0,o.jsx)("span",{children:"Progress"}),(0,o.jsxs)("span",{children:[(null===(d=s.stats)||void 0===d?void 0:d.completionPercentage)||0,"%"]})]}),(0,o.jsx)("div",{className:"progress-bar-background",children:(0,o.jsx)("div",{className:"progress-bar",style:{width:"".concat((null===(h=s.stats)||void 0===h?void 0:h.completionPercentage)||0,"%"),backgroundColor:(v=(null===(m=s.stats)||void 0===m?void 0:m.completionPercentage)||0,100===v?"#4CAF50":v>=75?"#8BC34A":v>=50?"#FFC107":v>=25?"#FF9800":"#F44336")}})})]})]}))}},s._id))),s.placeholder]}))})})]})]})}}}]);
//# sourceMappingURL=13.3299e2fe.chunk.js.map