"use strict";(self.webpackChunkdynet=self.webpackChunkdynet||[]).push([[841],{4677:(e,t,n)=>{n.d(t,{Z:()=>i,y:()=>r});var o=n(3263);const a={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE_URL||"https://backend-dynet2-1.onrender.com",r=o.Z.create({baseURL:a,headers:{"Content-Type":"application/json"},withCredentials:!0}),s=o.Z.create({baseURL:a,headers:{"Content-Type":"application/json"},withCredentials:!0});s.interceptors.response.use((e=>e),(async e=>{var t;return 401===(null===(t=e.response)||void 0===t?void 0:t.status)&&(localStorage.removeItem("accessToken"),localStorage.removeItem("roles"),window.location.href="/login"),Promise.reject(e)}));const i=s},6965:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(1413),a=n(2791),r=n(4677),s=n(4391),i=n(7834),c=n(3263);const l=()=>{const{auth:e,setAuth:t,logout:n}=(0,i.Z)();return(0,a.useEffect)((()=>{const a=r.Z.interceptors.request.use((t=>(t.headers.Authorization||(t.headers.Authorization="Bearer ".concat(null===e||void 0===e?void 0:e.accessToken)),t)),(e=>Promise.reject(e))),i=r.Z.interceptors.response.use((e=>e),(async e=>{var a,i;const l=null===e||void 0===e?void 0:e.config;if(403===(null===(a=e.response)||void 0===a?void 0:a.status)&&(null===l||void 0===l||!l.sent)){l.sent=!0;try{s.Z.log("Token expired, attempting refresh...");const e=(await c.Z.get("/refresh",{withCredentials:!0})).data.accessToken;return t((t=>(0,o.Z)((0,o.Z)({},t),{},{accessToken:e}))),localStorage.setItem("accessToken",e),l.headers.Authorization="Bearer ".concat(e),(0,r.Z)(l)}catch(d){s.Z.error("Token refresh failed:",d),n()}}return 401===(null===(i=e.response)||void 0===i?void 0:i.status)&&n(),Promise.reject(e)}));return()=>{r.Z.interceptors.request.eject(a),r.Z.interceptors.response.eject(i)}}),[e,t,n]),r.Z}},3363:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var o=n(2791),a=n(2928),r=n(4391),s=n(9098),i=n(1051),c=n(9254),l=n(467),d=n(8770),p=(n(5852),n(4310),n(6965)),h=n(8421),g=n(1183),u=n(184);const f={nl:d.Z},m=(0,a.lD)({format:s.Z,parse:i.Z,startOfWeek:c.Z,getDay:l.Z,locales:f}),x={timeGutterFormat:"HH:mm",eventTimeRangeFormat:(e,t,n)=>{let{start:o,end:a}=e;return n.format(o,"HH:mm",t)+" - "+n.format(a,"HH:mm",t)},dayHeaderFormat:"eeee, d MMMM yyyy",dayRangeHeaderFormat:(e,t,n)=>{let{start:o,end:a}=e;return n.format(o,"d MMMM",t)+" - "+n.format(a,"d MMMM yyyy",t)}},y=()=>{const e=(0,p.Z)(),[t,n]=(0,o.useState)([]),[s,i]=(0,o.useState)([]),[c,l]=(0,o.useState)(!1),[d,f]=(0,o.useState)([]),[y,v]=(0,o.useState)(""),[b,w]=(0,o.useState)(new Date),S=(0,o.useCallback)((async()=>{try{const t=await e.get("/api/users"),n=t.data.filter((e=>e.roles&&"object"===typeof e.roles&&8687===e.roles.TechnischeSchouwer));r.Z.log("Found Technische Schouwers:",n),f(n),await(0,g.zM)(e)}catch(t){r.Z.error("Error fetching technische schouwers:",t)}}),[e]),Z=(0,o.useCallback)((async()=>{try{var t;l(!0),r.Z.log("Fetching all appointments without date filtering.");const o=await e.get("/api/apartment/appointments/all-technischeplanning",{params:{limit:500}});(null===o||void 0===o||null===(t=o.data)||void 0===t?void 0:t.length)>0?r.Z.log("Appointments fetched successfully:",o.data):r.Z.log("No appointments found.");const a=o.data.filter((e=>{var t,n,o,a;return(null===(t=e.technischePlanning)||void 0===t||null===(n=t.appointmentBooked)||void 0===n?void 0:n.date)&&(null===(o=e.technischePlanning)||void 0===o||null===(a=o.appointmentBooked)||void 0===a?void 0:a.startTime)})).map((e=>{const t=new Date(e.technischePlanning.appointmentBooked.date),[n,o]=e.technischePlanning.appointmentBooked.startTime.split(":"),[a,r]=e.technischePlanning.appointmentBooked.endTime?e.technischePlanning.appointmentBooked.endTime.split(":"):[n,o],s=new Date(t);s.setHours(parseInt(n),parseInt(o),0,0);const i=new Date(t);return i.setHours(parseInt(a),parseInt(r),0,0),{id:e._id,title:"Technical Inspection - ".concat(e.complexNaam||"".concat(e.adres," ").concat(e.huisNummer).concat(e.toevoeging||"")),start:s,end:i,personName:e.technischePlanning.technischeSchouwerName,resource:{address:"".concat(e.adres," ").concat(e.huisNummer).concat(e.toevoeging||""),phone:e.technischePlanning.telephone||"Not provided",notes:e.technischePlanning.additionalNotes||"No notes",flatId:e._id,complexNaam:e.complexNaam||"N/A"}}}));i(a),n(a)}catch(o){r.Z.error("Error fetching appointments:",o)}finally{l(!1)}}),[e]);(0,o.useEffect)((()=>{S(),Z()}),[S,Z]);return(0,u.jsx)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:(0,u.jsxs)("div",{style:{maxWidth:"1400px",margin:"0 auto",background:"#ffffff",borderRadius:"20px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)",overflow:"hidden"},children:[(0,u.jsxs)("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",padding:"40px",borderBottom:"1px solid #e2e8f0"},children:[(0,u.jsxs)("h1",{style:{color:"#2c3e50",fontSize:"32px",fontWeight:"700",margin:"0 0 10px 0",display:"flex",alignItems:"center",gap:"12px"},children:[(0,u.jsx)("span",{style:{fontSize:"36px"},children:"\ud83d\udcc5"}),"Technical Planning Calendar"]}),(0,u.jsx)("p",{style:{color:"#6c757d",fontSize:"18px",margin:"0",fontWeight:"400"},children:"View and manage technical inspection appointments"})]}),(0,u.jsxs)("div",{style:{padding:"40px"},children:[d.length>0&&(0,u.jsx)("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #ffffff 100%)",border:"2px solid #e2e8f0",borderRadius:"16px",padding:"24px",marginBottom:"32px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.05)"},children:(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"16px",flexWrap:"wrap"},children:[(0,u.jsx)("label",{htmlFor:"schouwerFilter",style:{color:"#374151",fontSize:"16px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:"\ud83d\udc77 Filter by Inspector:"}),(0,u.jsxs)("select",{id:"schouwerFilter",value:y,onChange:e=>{const t=e.target.value;if(v(t),t){const e=s.filter((e=>e.personName===t));if(n(e),e.length>0){const n=e.sort(((e,t)=>new Date(e.start)-new Date(t.start)))[0],o=new Date(n.start);w(o),r.Z.log("Auto-navigated to ".concat(o.toLocaleDateString("en-US",{month:"long",year:"numeric"})," for ").concat(t,"'s first appointment"))}}else n(s)},style:{padding:"12px 16px",border:"2px solid #e5e7eb",borderRadius:"10px",fontSize:"16px",fontFamily:"inherit",transition:"all 0.2s ease",backgroundColor:"#ffffff",color:"#374151",outline:"none",minWidth:"280px",cursor:"pointer"},onFocus:e=>{e.target.style.borderColor="#667eea",e.target.style.boxShadow="0 0 0 3px rgba(102, 126, 234, 0.1)"},onBlur:e=>{e.target.style.borderColor="#e5e7eb",e.target.style.boxShadow="none"},children:[(0,u.jsx)("option",{value:"",children:"All Technical Inspectors"}),d.map((e=>(0,u.jsx)("option",{value:e.name,children:e.name},e._id)))]})]})}),(0,u.jsxs)("div",{style:{background:"#ffffff",border:"2px solid #e2e8f0",borderRadius:"16px",overflow:"hidden",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.05)",minHeight:"600px"},children:[(0,u.jsxs)("div",{style:{background:"linear-gradient(135deg, #e0f2fe 0%, #b3e5fc 100%)",padding:"16px",borderBottom:"1px solid #e2e8f0",textAlign:"center",fontSize:"14px",color:"#0277bd",fontWeight:"500"},children:["\ud83d\udccb Click on any appointment to view details \u2022 Use the filter above to view specific inspector schedules",y&&(0,u.jsxs)("div",{style:{marginTop:"8px",fontSize:"13px",color:"#1565c0"},children:["\u2022 Currently showing: ",y," (",t.length," appointments)",(0,u.jsx)("br",{}),"\ud83d\udcc5 Auto-navigated to ",b.toLocaleDateString("en-US",{month:"long",year:"numeric"})]})]}),(0,u.jsx)("div",{style:{padding:"20px",height:"700px"},children:c?(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",gap:"20px"},children:[(0,u.jsx)(h.Z,{color:"#667eea",size:60}),(0,u.jsx)("p",{style:{color:"#6c757d",fontSize:"16px",margin:"0"},children:"Loading appointments..."})]}):(0,u.jsx)(a.f,{localizer:m,events:t,startAccessor:"start",endAccessor:"end",style:{height:"100%"},date:b,onNavigate:e=>w(e),onRangeChange:e=>{e.start&&e.end&&r.Z.log("Calendar range changed to:",e.start,"to",e.end)},onSelectEvent:e=>{const{resource:t}=e;alert("\n            \ud83d\udccb Technical Inspection Details\n            \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n            \ud83c\udfe0 Address: ".concat(t.address,"\n            \ud83d\udcde Phone: ").concat(t.phone,"\n            \ud83d\udcdd Notes: ").concat(t.notes,"\n            \ud83c\udfe2 Complex: ").concat(t.complexNaam,"\n            \ud83d\udc77 Inspector: ").concat(e.personName||"Not assigned","\n        "))},eventPropGetter:e=>{const t=40+30*((e.end&&e.start?(e.end-e.start)/6e4:60)/60),n=Math.max(40,Math.min(t,120)),o=(0,g.x6)(e.personName,"#3498db"),a=(0,g.r5)(o,15);return{style:{backgroundColor:o,borderRadius:"4px",opacity:.9,color:"white",border:"1px solid ".concat(a),display:"block",padding:"5px 10px",height:"".concat(n,"px"),minHeight:"".concat(40,"px"),overflow:"hidden",fontSize:"12px",fontWeight:"500",lineHeight:"1.3"}}},views:["month","week","day"],defaultView:"month",min:new Date(2024,0,1,6,0,0),max:new Date(2024,0,1,22,0,0),step:60,timeslots:1,showMultiDayTimes:!0,formats:x})})]})]})]})})}},1183:(e,t,n)=>{n.d(t,{r5:()=>d,x6:()=>l,zM:()=>c});var o=n(4677),a=n(4391);let r={},s=null;const i=3e5,c=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=Date.now();if(s&&t-s<i&&Object.keys(r).length>0)return a.Z.log("Using cached user colors"),r;a.Z.log("Fetching user colors from API");const n=e||o.Z,c=(await n.get("/api/users")).data,l={};return c.forEach((e=>{e.name&&e.color&&(l[e.name]=e.color)})),r=l,s=t,a.Z.log("User colors cached:",l),l}catch(t){return a.Z.error("Error fetching user colors:",t),{}}},l=e=>{if(!e)return"#3498db";return r[e]||"#3498db"},d=(e,t)=>{const n=e.replace("#",""),o=parseInt(n.substr(0,2),16),a=parseInt(n.substr(2,2),16),r=parseInt(n.substr(4,2),16),s=(100-t)/100,i=Math.round(o*s),c=Math.round(a*s),l=Math.round(r*s);return"#"+i.toString(16).padStart(2,"0")+c.toString(16).padStart(2,"0")+l.toString(16).padStart(2,"0")}},4310:()=>{}}]);
//# sourceMappingURL=841.27408b3d.chunk.js.map