"use strict";(self.webpackChunkdynet=self.webpackChunkdynet||[]).push([[138],{4677:(n,t,e)=>{e.d(t,{Z:()=>l,y:()=>o});var a=e(3263);const i={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE_URL||"https://backend-dynet2-1.onrender.com",o=a.Z.create({baseURL:i,headers:{"Content-Type":"application/json"},withCredentials:!0}),s=a.Z.create({baseURL:i,headers:{"Content-Type":"application/json"},withCredentials:!0});s.interceptors.response.use((n=>n),(async n=>{var t;return 401===(null===(t=n.response)||void 0===t?void 0:t.status)&&(localStorage.removeItem("accessToken"),localStorage.removeItem("roles"),window.location.href="/login"),Promise.reject(n)}));const l=s},6138:(n,t,e)=>{e.r(t),e.d(t,{default:()=>r});var a=e(2791),i=e(6965),o=e(7834),s=e(3585),l=e(4391),d=e(184);const r=()=>{var n,t,e,r,c;const u=(0,i.Z)(),{auth:p}=(0,o.Z)(),[h,v]=(0,a.useState)({}),[m,g]=(0,a.useState)(!1),f=null===p||void 0===p||null===(n=p.roles)||void 0===n?void 0:n.includes(s.K$.ADMIN),A=null===p||void 0===p||null===(t=p.roles)||void 0===t?void 0:t.includes(s.K$.TECHNICAL_PLANNING),k=null===p||void 0===p||null===(e=p.roles)||void 0===e?void 0:e.includes(s.K$.HAS_PLANNING),b=null===p||void 0===p||null===(r=p.roles)||void 0===r?void 0:r.includes(s.K$.TECHNICAL_INSPECTOR),S=null===p||void 0===p||null===(c=p.roles)||void 0===c?void 0:c.includes(s.K$.HAS_MONTEUR),T=async()=>{const n=[];try{var t;const b=await u.get("/api/apartment/appointments/all-technischeplanning",{params:{limit:10}});if(n.push({test:"Fetch Technical Appointments",status:b.data?"PASS":"FAIL",data:(null===(t=b.data)||void 0===t?void 0:t.length)||0}),b.data&&b.data.length>0){var e,a,i,o,s,l,d,r,c,p,h,v,m,g,f,A,k;const t=b.data[0],u=(null===(e=t.technischePlanning)||void 0===e||null===(a=e.appointmentBooked)||void 0===a?void 0:a.date)&&(null===(i=t.technischePlanning)||void 0===i||null===(o=i.appointmentBooked)||void 0===o?void 0:o.startTime)&&(null===(s=t.technischePlanning)||void 0===s||null===(l=s.appointmentBooked)||void 0===l?void 0:l.endTime)&&(null===(d=t.technischePlanning)||void 0===d||null===(r=d.appointmentBooked)||void 0===r?void 0:r.weekNumber);n.push({test:"Technical Appointment Data Structure",status:u?"PASS":"FAIL",details:{hasDate:!(null===(c=t.technischePlanning)||void 0===c||null===(p=c.appointmentBooked)||void 0===p||!p.date),hasStartTime:!(null===(h=t.technischePlanning)||void 0===h||null===(v=h.appointmentBooked)||void 0===v||!v.startTime),hasEndTime:!(null===(m=t.technischePlanning)||void 0===m||null===(g=m.appointmentBooked)||void 0===g||!g.endTime),hasWeekNumber:!(null===(f=t.technischePlanning)||void 0===f||null===(A=f.appointmentBooked)||void 0===A||!A.weekNumber),hasTechnician:!(null===(k=t.technischePlanning)||void 0===k||!k.technischeSchouwerName)}})}}catch(b){n.push({test:"Technical Appointments API",status:"FAIL",error:b.message})}return n},x=async()=>{const n=[];try{var t;const T=await u.get("/api/apartment/appointments/all-hasmonteur",{params:{limit:10}});if(n.push({test:"Fetch HAS Appointments",status:T.data?"PASS":"FAIL",data:(null===(t=T.data)||void 0===t?void 0:t.length)||0}),T.data&&T.data.length>0){var e,a,i,o,s,l,d,r,c,p,h,v,m,g,f,A,k,b,S;const t=T.data[0],u=(null===(e=t.hasMonteur)||void 0===e||null===(a=e.appointmentBooked)||void 0===a?void 0:a.date)&&(null===(i=t.hasMonteur)||void 0===i||null===(o=i.appointmentBooked)||void 0===o?void 0:o.startTime)&&(null===(s=t.hasMonteur)||void 0===s||null===(l=s.appointmentBooked)||void 0===l?void 0:l.endTime)&&(null===(d=t.hasMonteur)||void 0===d||null===(r=d.appointmentBooked)||void 0===r?void 0:r.weekNumber);n.push({test:"HAS Appointment Data Structure",status:u?"PASS":"FAIL",details:{hasDate:!(null===(c=t.hasMonteur)||void 0===c||null===(p=c.appointmentBooked)||void 0===p||!p.date),hasStartTime:!(null===(h=t.hasMonteur)||void 0===h||null===(v=h.appointmentBooked)||void 0===v||!v.startTime),hasEndTime:!(null===(m=t.hasMonteur)||void 0===m||null===(g=m.appointmentBooked)||void 0===g||!g.endTime),hasWeekNumber:!(null===(f=t.hasMonteur)||void 0===f||null===(A=f.appointmentBooked)||void 0===A||!A.weekNumber),hasMonteur:!(null===(k=t.hasMonteur)||void 0===k||!k.hasMonteurName),hasType:!(null===(b=t.hasMonteur)||void 0===b||null===(S=b.appointmentBooked)||void 0===S||!S.type)}})}}catch(T){n.push({test:"HAS Appointments API",status:"FAIL",error:T.message})}return n},w=async()=>{const n=[];try{const t=await u.get("/api/building",{params:{limit:5}});if(t.data&&t.data.length>0){const e=t.data[0];if(e.flats&&e.flats.length>0){const t=e.flats.filter((n=>{var t,e;return null===(t=n.technischePlanning)||void 0===t||null===(e=t.appointmentBooked)||void 0===e?void 0:e.date})),a=e.flats.filter((n=>{var t,e;return null===(t=n.hasMonteur)||void 0===t||null===(e=t.appointmentBooked)||void 0===e?void 0:e.date}));n.push({test:"Building Flats with Technical Appointments",status:"PASS",data:t.length}),n.push({test:"Building Flats with HAS Appointments",status:"PASS",data:a.length})}}}catch(t){n.push({test:"Appointment Display",status:"FAIL",error:t.message})}return n},y=async()=>{const n=[];try{if(f||A){const t=(await u.get("/api/apartment/appointments/all-technischeplanning",{params:{limit:50}})).data.filter((n=>{var t,e,a,i;return(null===(t=n.technischePlanning)||void 0===t||null===(e=t.appointmentBooked)||void 0===e?void 0:e.date)&&(null===(a=n.technischePlanning)||void 0===a||null===(i=a.appointmentBooked)||void 0===i?void 0:i.startTime)})).map((n=>{const t=n.technischePlanning.appointmentBooked;return{hasValidDate:!!t.date,hasValidTime:!!t.startTime&&!!t.endTime,hasLocation:!(!n.adres||!n.huisNummer),hasTechnician:!!n.technischePlanning.technischeSchouwerName}}));n.push({test:"Technical Calendar Events",status:t.length>0?"PASS":"WARN",data:t.length,validEvents:t.filter((n=>n.hasValidDate&&n.hasValidTime&&n.hasLocation)).length})}if(f||k){const t=(await u.get("/api/apartment/appointments/all-hasmonteur",{params:{limit:50}})).data.filter((n=>{var t,e,a,i;return(null===(t=n.hasMonteur)||void 0===t||null===(e=t.appointmentBooked)||void 0===e?void 0:e.date)&&(null===(a=n.hasMonteur)||void 0===a||null===(i=a.appointmentBooked)||void 0===i?void 0:i.startTime)})).map((n=>{const t=n.hasMonteur.appointmentBooked;return{hasValidDate:!!t.date,hasValidTime:!!t.startTime&&!!t.endTime,hasLocation:!(!n.adres||!n.huisNummer),hasMonteur:!!n.hasMonteur.hasMonteurName,hasType:!!t.type}}));n.push({test:"HAS Calendar Events",status:t.length>0?"PASS":"WARN",data:t.length,validEvents:t.filter((n=>n.hasValidDate&&n.hasValidTime&&n.hasLocation)).length})}}catch(t){n.push({test:"Calendar Integration",status:"FAIL",error:t.message})}return n},N=async()=>{const n=[];try{const t=new Date("2024-06-15"),e=P(t),a=B(t);n.push({test:"Week Number Calculation Consistency",status:e===a?"PASS":"FAIL",details:{method1:e,method2:a}});const i="2024-06-15",o=new Date(i).toISOString().split("T")[0],s=C(i);n.push({test:"Date Formatting Consistency",status:o===s?"PASS":"FAIL",details:{method1:o,method2:s}})}catch(t){n.push({test:"Data Consistency",status:"FAIL",error:t.message})}return n},P=n=>{const t=new Date(n),e=new Date(t.getFullYear(),0,1),a=Math.floor((t-e)/864e5);return Math.ceil(a/7)},B=n=>{const t=new Date(n.getFullYear(),0,1),e=Math.floor((n-t)/864e5);return Math.ceil((n.getDay()+1+e)/7)},C=n=>{if(!n)return"";return new Date(n).toISOString().split("T")[0]};return(0,d.jsxs)("div",{className:"appointment-system-validator",children:[(0,d.jsx)("h2",{children:"Appointment System Validation"}),(0,d.jsxs)("p",{children:["Current Role: ",f?"Admin":A?"Technical Planning":k?"HAS Planning":b?"Technical Inspector":S?"HAS Monteur":"Unknown"]}),(0,d.jsx)("button",{onClick:async()=>{g(!0);const n={};try{(f||A)&&(n.technicalAppointments=await T()),(f||k)&&(n.hasAppointments=await x()),n.appointmentDisplay=await w(),n.calendarIntegration=await y(),n.dataConsistency=await N(),v(n)}catch(t){l.Z.error("Validation error:",t),n.error=t.message,v(n)}finally{g(!1)}},disabled:m,children:m?"Validating...":"Run Validation Tests"}),m?(0,d.jsx)("div",{className:"validation-loading",children:"Running validation tests..."}):(0,d.jsx)("div",{className:"validation-results",children:Object.entries(h).map((n=>{let[t,e]=n;return(0,d.jsxs)("div",{className:"validation-category",children:[(0,d.jsx)("h3",{children:t.replace(/([A-Z])/g," $1").toUpperCase()}),Array.isArray(e)?e.map(((n,t)=>(0,d.jsxs)("div",{className:"validation-item ".concat(n.status.toLowerCase()),children:[(0,d.jsx)("div",{className:"validation-test",children:n.test}),(0,d.jsx)("div",{className:"validation-status",children:n.status}),void 0!==n.data&&(0,d.jsxs)("div",{className:"validation-data",children:["Data: ",n.data]}),void 0!==n.validEvents&&(0,d.jsxs)("div",{className:"validation-data",children:["Valid Events: ",n.validEvents]}),n.details&&(0,d.jsx)("div",{className:"validation-details",children:JSON.stringify(n.details,null,2)}),n.error&&(0,d.jsxs)("div",{className:"validation-error",children:["Error: ",n.error]})]},t))):(0,d.jsx)("div",{className:"validation-error",children:e})]},t)}))}),(0,d.jsx)("style",{jsx:!0,children:"\n                .appointment-system-validator {\n                    padding: 20px;\n                    max-width: 1000px;\n                    margin: 0 auto;\n                }\n\n                .validation-loading {\n                    text-align: center;\n                    padding: 20px;\n                    font-style: italic;\n                }\n\n                .validation-category {\n                    margin-bottom: 30px;\n                    border: 1px solid #ddd;\n                    border-radius: 8px;\n                    overflow: hidden;\n                }\n\n                .validation-category h3 {\n                    margin: 0;\n                    padding: 15px;\n                    background: #f5f5f5;\n                    border-bottom: 1px solid #ddd;\n                }\n\n                .validation-item {\n                    padding: 15px;\n                    border-bottom: 1px solid #eee;\n                }\n\n                .validation-item:last-child {\n                    border-bottom: none;\n                }\n\n                .validation-item.pass {\n                    background: #f0f8ff;\n                    border-left: 4px solid #4CAF50;\n                }\n\n                .validation-item.fail {\n                    background: #fff5f5;\n                    border-left: 4px solid #f44336;\n                }\n\n                .validation-item.warn {\n                    background: #fffbf0;\n                    border-left: 4px solid #ff9800;\n                }\n\n                .validation-test {\n                    font-weight: bold;\n                    margin-bottom: 5px;\n                }\n\n                .validation-status {\n                    display: inline-block;\n                    padding: 2px 8px;\n                    border-radius: 4px;\n                    font-size: 12px;\n                    font-weight: bold;\n                }\n\n                .validation-item.pass .validation-status {\n                    background: #4CAF50;\n                    color: white;\n                }\n\n                .validation-item.fail .validation-status {\n                    background: #f44336;\n                    color: white;\n                }\n\n                .validation-item.warn .validation-status {\n                    background: #ff9800;\n                    color: white;\n                }\n\n                .validation-data {\n                    margin-top: 5px;\n                    font-size: 14px;\n                    color: #666;\n                }\n\n                .validation-details {\n                    margin-top: 10px;\n                    background: #f9f9f9;\n                    padding: 10px;\n                    border-radius: 4px;\n                    font-family: monospace;\n                    font-size: 12px;\n                    white-space: pre-wrap;\n                }\n\n                .validation-error {\n                    margin-top: 5px;\n                    color: #f44336;\n                    font-size: 14px;\n                }\n\n                button {\n                    background: #3498db;\n                    color: white;\n                    border: none;\n                    padding: 12px 24px;\n                    border-radius: 6px;\n                    cursor: pointer;\n                    font-size: 16px;\n                    margin-bottom: 20px;\n                }\n\n                button:disabled {\n                    background: #bdc3c7;\n                    cursor: not-allowed;\n                }\n\n                button:hover:not(:disabled) {\n                    background: #2980b9;\n                }\n            "})]})}},6965:(n,t,e)=>{e.d(t,{Z:()=>r});var a=e(1413),i=e(2791),o=e(4677),s=e(4391),l=e(7834),d=e(3263);const r=()=>{const{auth:n,setAuth:t,logout:e}=(0,l.Z)();return(0,i.useEffect)((()=>{const i=o.Z.interceptors.request.use((t=>(t.headers.Authorization||(t.headers.Authorization="Bearer ".concat(null===n||void 0===n?void 0:n.accessToken)),t)),(n=>Promise.reject(n))),l=o.Z.interceptors.response.use((n=>n),(async n=>{var i,l;const r=null===n||void 0===n?void 0:n.config;if(403===(null===(i=n.response)||void 0===i?void 0:i.status)&&(null===r||void 0===r||!r.sent)){r.sent=!0;try{s.Z.log("Token expired, attempting refresh...");const n=(await d.Z.get("/refresh",{withCredentials:!0})).data.accessToken;return t((t=>(0,a.Z)((0,a.Z)({},t),{},{accessToken:n}))),localStorage.setItem("accessToken",n),r.headers.Authorization="Bearer ".concat(n),(0,o.Z)(r)}catch(c){s.Z.error("Token refresh failed:",c),e()}}return 401===(null===(l=n.response)||void 0===l?void 0:l.status)&&e(),Promise.reject(n)}));return()=>{o.Z.interceptors.request.eject(i),o.Z.interceptors.response.eject(l)}}),[n,t,e]),o.Z}}}]);
//# sourceMappingURL=138.b4f3f393.chunk.js.map